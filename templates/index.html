<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5種じゃんけん LSTM AI</title>
    <link rel="stylesheet" href="{{ url_for('static', path='style.css') }}">
</head>

<body>

    <div class="container">
        <header>
            <h1>👑 5種じゃんけん vs AI</h1>
            <p class="subtitle">AIはLSTMであなたのパターンを学習します</p>
        </header>

        <div class="main-content">
            <div class="status-panel">
                <div id="status" class="status-text">Ready?</div>
                
                <div class="moves-display">
                    <div class="move-box">
                        <div id="user-win-mark" class="winner-mark">🏆 WIN!</div>
                        <div class="move-label-header">あなた</div>
                        <div id="user-move" class="move-content">
                            <div class="move-emoji">-</div>
                            <div class="move-text-sub"></div>
                        </div>
                    </div>

                    <div style="font-size: 4vh; align-self: center; color:#ccc; padding-top: 2vh;">VS</div>

                    <div class="move-box">
                        <div id="ai-win-mark" class="winner-mark">🏆 WIN!</div>
                        <div class="move-label-header">AI</div>
                        <div id="ai-move" class="move-content">
                            <div class="move-emoji">-</div>
                            <div class="move-text-sub"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="chart-panel">
                <div class="chart-title">🧠 AIが予測したあなたの手の確率</div>
                <div id="chart-container">
                    <p style="color: #aaa; font-size: 2vh;">(データ収集中...)</p>
                </div>
            </div>
        </div>

        <footer>
            <div class="btn-group">
                <button class="move-btn btn-gu" onclick="play(0)">👊<span>グー</span></button>
                <button class="move-btn btn-choki" onclick="play(1)">✌️<span>チョキ</span></button>
                <button class="move-btn btn-pa" onclick="play(2)">🖐<span>パー</span></button>
                <button class="move-btn btn-king" onclick="play(3)">👑<span>王様</span></button>
                <button class="move-btn btn-commoner" onclick="play(4)">🧑‍🌾<span>農民</span></button>
            </div>
            
            <div class="meta-info">
                <span class="win-rate-display">
                    <span>あなたの勝率</span>
                    <span id="win-rate">-</span>%
                </span>
                
                <span class="win-rate-display">
                    <span>対戦数</span>
                    <span id="game-count">0</span>
                </span>
                
                <button class="footer-btn rule-btn" onclick="openModal('rule-modal')">📖<br>説明をよむ</button>
                <button class="footer-btn reset-btn" onclick="resetGame()">リセット</button>
            </div>
        </footer>
    </div>

    <div class="logo-container">
        <img src="/static/logo.png" alt="Club Logo" class="logo-img" onerror="this.style.display='none'">
    </div>

    <div id="rule-modal" class="modal" onclick="closeModalOutside(event, 'rule-modal')">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('rule-modal')">&times;</span>
            <h2 class="modal-h2">📖 5種じゃんけんのルール</h2>
            <ul class="rule-list">
                <li><b>👑 王様</b> は、グー・チョキ・パーに<b>勝ち</b>ますが，<b>🧑‍🌾 農民</b> には<b>負け</b>ます。</li>
                <li><b>🧑‍🌾 農民</b> は、グー・チョキ・パーに<b>負け</b>ますが，<b>👑 王様</b> には<b>勝ち</b>ます。</li>
                <li>グー・チョキ・パー同士は通常のルールと同じです。</li>
            </ul>

            <div style="background-color: #eafaf1; border-left: 5px solid #2ecc71; padding: 15px; margin: 20px 0;">
                <h3 style="margin-top:0; color:#27ae60;">🧪 体験してみてください</h3>
                <ul class="rule-list">
                    <li><b>グー 👊 → チョキ ✌️ → パー 🖐</b> の順番を繰り返してみてください。<br>最初は負けたり勝ったりしますが、何周かすると…？</li>
                </ul>
            </div>

        </div>
    </div>

    <div id="milestone-modal" class="modal" onclick="closeModalOutside(event, 'milestone-modal')">
        <div class="modal-content" style="text-align: center;">
            <span class="close-btn" onclick="closeModal('milestone-modal')">&times;</span>
            
            <h2 class="modal-h2">🎉 <span id="milestone-count">0</span>回プレイ達成！</h2>
            
            <div class="milestone-display">
                <p class="milestone-label">現在のあなたの勝率</p>
                <div class="milestone-value">
                    <span id="milestone-win-rate">-</span>
                    <span class="milestone-unit">%</span>
                </div>
            </div>
            <button class="footer-btn reset-btn" onclick="resetGame()" style="margin-top:20px;">
                🔄 リセット
            </button>
        </div>
    </div>

    <script src="{{ url_for('static', path='script.js') }}"></script>

</body>
</html>