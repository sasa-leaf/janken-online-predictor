<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5種じゃんけん LSTM AI</title>
    <link rel="stylesheet" href="{{ url_for('static', path='style.css') }}">
</head>

<body>

    <div class="container">
        <header>
            <h1>👑 5種じゃんけん vs AI</h1>
            <p class="subtitle">AIはLSTMであなたの癖を学習して強くなります</p>
        </header>

        <div class="main-content">
            <div class="status-panel">
                <div id="status" class="status-text">Ready?</div>
                
                <div class="moves-display">
                    <div class="move-box">
                        <div id="user-win-mark" class="winner-mark">🏆 WIN!</div>
                        <div class="move-label-header">あなた</div>
                        <div id="user-move" class="move-content">
                            <div class="move-emoji">-</div>
                            <div class="move-text-sub"></div>
                        </div>
                    </div>

                    <div style="font-size: 4vh; align-self: center; color:#ccc; padding-top: 2vh;">VS</div>

                    <div class="move-box">
                        <div id="ai-win-mark" class="winner-mark">🏆 WIN!</div>
                        <div class="move-label-header">AI</div>
                        <div id="ai-move" class="move-content">
                            <div class="move-emoji">-</div>
                            <div class="move-text-sub"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="chart-panel">
                <div class="chart-title">🧠 AIが予測したあなたの手の確率</div>
                <div id="chart-container">
                    <p style="color: #aaa; font-size: 2vh;">(データ収集中...)</p>
                </div>
            </div>
        </div>

        <footer>
            <div class="btn-group">
                <button class="move-btn btn-gu" onclick="play(0)">👊<br>グー</button>
                <button class="move-btn btn-choki" onclick="play(1)">✌️<br>チョキ</button>
                <button class="move-btn btn-pa" onclick="play(2)">🖐<br>パー</button>
                <button class="move-btn btn-king" onclick="play(3)">👑<br>王様</button>
                <button class="move-btn btn-slave" onclick="play(4)">🧑‍🌾<br>農民</button>
            </div>
            
            <div class="meta-info">
                <span class="win-rate-display">
                    <span>あなたの勝率</span>
                    <span id="win-rate">-</span>%
                </span>
                
                <span class="win-rate-display">
                    <span>対戦数</span>
                    <span id="game-count">0</span>
                </span>
                
                <button class="footer-btn rule-btn" onclick="openModal('rule-modal')">📖<br>ルール</button>
                <button class="footer-btn story-btn" onclick="openModal('dev-modal')">🤫<br>ヒント</button>
                <button class="footer-btn reset-btn" onclick="resetGame()">リセット</button>
            </div>
        </footer>
    </div>

    <div class="logo-container">
        <img src="/static/logo.png" alt="Club Logo" class="logo-img" onerror="this.style.display='none'">
    </div>

    <div id="rule-modal" class="modal" onclick="closeModalOutside(event, 'rule-modal')">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('rule-modal')">&times;</span>
            <h2 class="modal-h2">📖 5種じゃんけんのルール</h2>
            <ul class="rule-list">
                <li><b>👑 王様</b> は、グー・チョキ・パーに勝ちますが，<b>🧑‍🌾 農民</b> には負けます。</li>
                <li><b>🧑‍🌾 農民</b> は、グー・チョキ・パーに負けますが，<b>👑 王様</b> には勝ちます。</li>
                <li>グー・チョキ・パー同士は通常のルールと同じです。</li>
            </ul>
        </div>
    </div>

    <div id="dev-modal" class="modal" onclick="closeModalOutside(event, 'dev-modal')">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('dev-modal')">&times;</span>
            <h2 class="modal-h2">🤫 ヒント</h2>
            <p>AIはあなたの「過去の手のパターン」を記憶し、次に来る手を予測して、それに勝てる手を選んでいます。</p>
            
            <div style="background-color: #eafaf1; border-left: 5px solid #2ecc71; padding: 15px; margin: 20px 0;">
                <h3 style="margin-top:0; color:#27ae60;">🧪 体験してみてください</h3>
                <ul>
                    <li><b>グー 👊 → チョキ ✌️ → パー 🖐</b> の順番で、同じパターンを何度も繰り返し出してみてください。最初は負けたり勝ったりしますが、何周かすると…？</li>
                    <li>ランダムに手を出し続けると、AIはなかなか学習できません。</li>
                </ul>
            </div>
        </div>
    </div>

    <div id="milestone-modal" class="modal" onclick="closeModalOutside(event, 'milestone-modal')">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('milestone-modal')">&times;</span>
            <h2 class="modal-h2">🎉 50回プレイ達成！</h2>
            <p>ここまでの成績はこちら：</p>

            <ul style="font-size:2vh; line-height:1.8;">
                <li><b>勝率：</b> <span id="milestone-win-rate">-</span>%</li>
                <li><b>対戦数：</b> <span id="milestone-count">0</span></li>
            </ul>

            <button class="footer-btn reset-btn" onclick="resetGame()" style="margin-top:20px;">
                🔄 リセット
            </button>
        </div>
    </div>

    <script src="{{ url_for('static', path='script.js') }}"></script>

</body>
</html>